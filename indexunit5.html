<!doctype html>
<html lang="vi">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Unit 1: Generation Gap and Independent Life</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
        body {
            box-sizing: border-box;
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #f8f4ff 0%, #fff0f8 50%, #f0f8ff 100%);
            min-height: 100%;
            position: relative;
            overflow-x: hidden;
            color: #1a3a52;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(200, 180, 255, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 180, 220, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(180, 220, 255, 0.15) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            box-shadow: 
                0 25px 50px rgba(0,0,0,0.15),
                0 0 0 1px rgba(255,255,255,0.2);
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .header {
            background: linear-gradient(135deg, #f5f0ff 0%, #fff0f5 50%, #f0f5ff 100%);
            color: #333;
            padding: 40px 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: 
                radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 30px 30px;
            animation: float 20s linear infinite;
        }

        .header h1 {
            margin: 0;
            font-size: 2.8rem;
            font-weight: 800;
            text-shadow: 0 4px 20px rgba(0,0,0,0.3);
            position: relative;
            z-index: 2;
            background: linear-gradient(45deg, #6b5b95, #8e7cc3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        @keyframes float {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        .nav-tabs {
            display: flex;
            background: linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(248,249,250,0.9) 100%);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(0,0,0,0.1);
            overflow-x: auto;
            padding: 10px;
            gap: 5px;
        }

        .nav-tab {
            padding: 15px 25px;
            background: rgba(255,255,255,0.7);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 15px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            color: #1a3a52;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            white-space: nowrap;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .nav-tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s;
        }

        .nav-tab:hover::before {
            left: 100%;
        }

        .nav-tab:hover {
            background: rgba(255,255,255,0.9);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #c8b5ff 0%, #ffb5dc 100%);
            color: white;
            box-shadow: 0 8px 25px rgba(200, 181, 255, 0.4);
        }

        .content {
            padding: 30px;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .lesson-card {
            background: rgba(255,255,255,0.8);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .lesson-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .lesson-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1a3a52;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .lesson-icon {
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #c8b5ff, #ffb5dc);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1rem;
        }

        .flashcard-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0;
            padding: 15px 20px;
            background: rgba(255,255,255,0.8);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .flashcard-counter {
            font-size: 1.1rem;
            font-weight: 600;
            color: #1a3a52;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        .nav-btn {
            padding: 10px 20px;
            background: linear-gradient(135deg, #c8b5ff, #ffb5dc);
            color: white;
            border: none;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(200, 181, 255, 0.4);
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .flashcard-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
            min-height: 250px;
            position: relative;
        }

        .flashcard {
            background: transparent;
            width: 400px;
            height: 200px;
            perspective: 1000px;
            cursor: pointer;
            display: none;
            opacity: 0;
            transform: translateX(50px);
            transition: all 0.5s ease;
        }

        .flashcard.active {
            display: block;
            opacity: 1;
            transform: translateX(0);
        }

        .flashcard-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        .flashcard.flipped .flashcard-inner {
            transform: rotateY(180deg);
        }

        .flashcard-front, .flashcard-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            background: rgba(255,255,255,0.9);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .flashcard-back {
            transform: rotateY(180deg);
            background: linear-gradient(135deg, rgba(200, 181, 255, 0.15), rgba(255, 181, 220, 0.15));
        }

        .flashcard:hover .flashcard-front,
        .flashcard:hover .flashcard-back {
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }

        .vocab-word {
            font-size: 1.2rem;
            font-weight: 600;
            color: #c8b5ff;
            margin-bottom: 8px;
        }

        .vocab-pronunciation {
            font-size: 0.9rem;
            color: #666;
            font-style: italic;
            margin-bottom: 10px;
        }

        .vocab-meaning {
            font-size: 1rem;
            color: #333;
            line-height: 1.5;
        }

        .flip-hint {
            font-size: 0.8rem;
            color: #666;
            font-style: italic;
            margin-top: 10px;
            opacity: 0.7;
        }

        .audio-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: linear-gradient(135deg, #ffe4e1, #ffd1dc);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 209, 220, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .audio-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(255, 209, 220, 0.5);
        }

        .audio-btn:active {
            transform: scale(0.95);
        }

        .exercise-container {
            background: rgba(255,255,255,0.9);
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
        }

        .question {
            font-size: 1.1rem;
            font-weight: 600;
            color: #1a3a52;
            margin-bottom: 15px;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option {
            padding: 12px 20px;
            background: rgba(255,255,255,0.8);
            border: 2px solid rgba(0,0,0,0.1);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option:hover {
            background: rgba(200, 181, 255, 0.15);
            border-color: #c8b5ff;
        }

        .option.selected {
            background: #c8b5ff;
            color: white;
            border-color: #c8b5ff;
        }

        .option.correct {
            background: #10b981;
            color: white;
            border-color: #10b981;
        }

        .option.incorrect {
            background: #ef4444;
            color: white;
            border-color: #ef4444;
        }

        .check-btn {
            background: linear-gradient(135deg, #c8b5ff, #ffb5dc);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 15px;
            transition: all 0.3s ease;
        }

        .check-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(200, 181, 255, 0.4);
        }

        .check-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 10px;
            font-weight: 600;
            display: none;
        }

        .feedback.correct {
            background: rgba(16, 185, 129, 0.1);
            color: #10b981;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .feedback.incorrect {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(0,0,0,0.1);
            border-radius: 4px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #c8b5ff, #ffb5dc);
            width: 0%;
            transition: width 0.5s ease;
        }

        .score-display {
            text-align: center;
            font-size: 1.2rem;
            font-weight: 600;
            color: #1a3a52;
            margin-top: 15px;
        }

        .overall-progress {
            background: rgba(255,255,255,0.9);
            border-radius: 20px;
            padding: 25px;
            margin: 20px 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            backdrop-filter: blur(10px);
        }

        .overall-progress h3 {
            text-align: center;
            color: #1a3a52;
            margin-bottom: 20px;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .progress-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .progress-item {
            background: rgba(255,255,255,0.8);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 2px solid rgba(200, 181, 255, 0.3);
            transition: all 0.3s ease;
        }

        .progress-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(200, 181, 255, 0.3);
            border-color: #c8b5ff;
        }

        .progress-item h4 {
            color: #c8b5ff;
            margin-bottom: 10px;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .progress-score {
            font-size: 2rem;
            font-weight: 800;
            color: #1a3a52;
            margin-bottom: 5px;
        }

        .progress-label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 10px;
        }

        .progress-bar-small {
            width: 100%;
            height: 6px;
            background: rgba(0,0,0,0.1);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill-small {
            height: 100%;
            background: linear-gradient(135deg, #c8b5ff, #ffb5dc);
            width: 0%;
            transition: width 0.5s ease;
        }

        .overall-score {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, rgba(200, 181, 255, 0.15), rgba(255, 181, 220, 0.15));
            border-radius: 15px;
            margin-top: 20px;
        }

        .overall-score h4 {
            color: #1a3a52;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .overall-score-value {
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(45deg, #c8b5ff, #ffb5dc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .overall-level {
            font-size: 1.1rem;
            font-weight: 600;
            color: #c8b5ff;
        }

        .achievement-badges {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .badge {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #333;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .badge.hidden {
            background: rgba(0,0,0,0.1);
            color: #999;
            box-shadow: none;
        }

        .reading-passage {
            line-height: 1.8;
            font-size: 1.1rem;
            position: relative;
        }

        .vocab-highlight {
            background: linear-gradient(135deg, rgba(200, 181, 255, 0.25), rgba(255, 181, 220, 0.25));
            padding: 2px 6px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            color: #c8b5ff;
            border: 1px solid rgba(200, 181, 255, 0.4);
            transition: all 0.3s ease;
            position: relative;
        }

        .vocab-highlight:hover {
            background: linear-gradient(135deg, rgba(200, 181, 255, 0.35), rgba(255, 181, 220, 0.35));
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(200, 181, 255, 0.3);
        }

        .vocabulary-tooltip {
            position: absolute;
            background: rgba(254, 247, 255, 0.98);
            border: 1px solid rgba(200, 181, 255, 0.4);
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            z-index: 1000;
            min-width: 250px;
            display: none;
            pointer-events: none;
        }

        .vocabulary-tooltip.show {
            display: block;
            pointer-events: auto;
            animation: tooltipFadeIn 0.3s ease;
        }

        @keyframes tooltipFadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .tooltip-word {
            font-size: 1.3rem;
            font-weight: 700;
            color: #c8b5ff;
            margin-bottom: 5px;
        }

        .tooltip-pronunciation {
            font-size: 1rem;
            color: #666;
            font-style: italic;
            margin-bottom: 8px;
        }

        .tooltip-meaning {
            font-size: 1rem;
            color: #333;
            line-height: 1.4;
            margin-bottom: 10px;
        }

        .tooltip-audio {
            background: linear-gradient(135deg, #ffe4e1, #ffd1dc);
            border: none;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 209, 220, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            float: right;
        }

        .tooltip-audio:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(255, 209, 220, 0.5);
        }

        .matching-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0;
            padding: 20px;
            background: rgba(255,255,255,0.8);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .matching-info {
            display: flex;
            gap: 30px;
            font-weight: 600;
            color: #1a3a52;
        }

        .matching-info > div {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .matching-info span {
            font-size: 1.2rem;
            color: #c8b5ff;
        }

        .matching-game-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }

        .matching-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            max-width: 800px;
            width: 100%;
        }

        .matching-card {
            aspect-ratio: 1;
            background: rgba(255,255,255,0.9);
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 600;
            text-align: center;
            padding: 10px;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .matching-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s;
        }

        .matching-card:hover::before {
            left: 100%;
        }

        .matching-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
            border-color: #667eea;
        }

        .matching-card.word {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            color: #667eea;
        }

        .matching-card.meaning {
            background: linear-gradient(135deg, rgba(255, 234, 167, 0.3), rgba(250, 177, 160, 0.3));
            color: #e17055;
        }

        .matching-card.selected {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
        }

        .matching-card.matched {
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
            cursor: default;
            animation: matchSuccess 0.6s ease;
        }

        .matching-card.wrong {
            background: linear-gradient(135deg, #e17055, #fd79a8);
            color: white;
            animation: wrongMatch 0.6s ease;
        }

        @keyframes matchSuccess {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes wrongMatch {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
            100% { transform: translateX(0); }
        }

        .matching-result {
            text-align: center;
            padding: 40px;
            background: rgba(255,255,255,0.9);
            border-radius: 20px;
            margin-top: 30px;
        }

        .matching-result h3 {
            color: #667eea;
            font-size: 2rem;
            margin-bottom: 15px;
        }

        .result-stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 25px 0;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .result-stats > div {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .result-stats span {
            font-size: 1.3rem;
            color: #667eea;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .nav-tabs {
                flex-wrap: wrap;
            }
            
            .vocabulary-grid {
                grid-template-columns: 1fr;
            }
            
            .content {
                padding: 20px;
            }

            .matching-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 10px;
            }

            .matching-info {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .matching-controls {
                flex-direction: column;
                gap: 20px;
            }

            .result-stats {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="container">
   <header class="header">
    <h1 id="unit-title">Unit 1: Generation Gap and Independent Life</h1>
   </header>
   <nav class="nav-tabs">
    <div class="nav-tab active" data-tab="vocabulary">
     Vocabulary
    </div>
    <div class="nav-tab" data-tab="grammar">
     Grammar
    </div>
    <div class="nav-tab" data-tab="reading">
     Reading
    </div>
    <div class="nav-tab" data-tab="matching">
     Matching Cards
    </div>
    <div class="nav-tab" data-tab="exercises">
     Exercises
    </div>
    <div class="nav-tab" data-tab="progress">
     📊 Overall Progress
    </div>
   </nav>
   <main class="content"><!-- Vocabulary Tab -->
    <div class="tab-content active" id="vocabulary">
     <div class="lesson-card">
      <div class="lesson-title">
       Key Vocabulary
      </div>
      <div class="flashcard-navigation">
       <div class="flashcard-counter"><span id="current-card">1</span> / <span id="total-cards">30</span>
       </div>
       <div class="nav-buttons"><button class="nav-btn" id="prev-btn" onclick="previousCard()" disabled>← Previous</button> <button class="nav-btn" id="next-btn" onclick="nextCard()">Next →</button>
       </div>
      </div>
      <div class="flashcard-container">
       <div class="flashcard active" id="card-0" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Digital
          </div>
          <div class="vocab-pronunciation">
           /ˈdɪdʒɪtl/
          </div><button class="audio-btn" onclick="playAudio('digital', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Kỹ thuật số - Converting an entire CD to digital format and downloading it to an MP3 player takes only about 10 to 15 minutes.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-1" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Space
          </div>
          <div class="vocab-pronunciation">
           /speɪs/
          </div><button class="audio-btn" onclick="playAudio('space', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Không gian - Is there any space for my clothes in that cupboard?
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-2" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Take off
          </div>
          <div class="vocab-pronunciation">
           /ˈteɪk ɒf/
          </div><button class="audio-btn" onclick="playAudio('take off', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Cởi ra - He took off his clothes and got into the shower.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-3" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Virtual
          </div>
          <div class="vocab-pronunciation">
           /ˈvɜːtʃuəl/
          </div><button class="audio-btn" onclick="playAudio('virtual', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Ảo - More shops will be online and malls will be virtual.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-4" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Connect
          </div>
          <div class="vocab-pronunciation">
           /kəˈnekt/
          </div><button class="audio-btn" onclick="playAudio('connect', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Kết nối - Can I connect my printer to your computer?
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-5" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Walkway
          </div>
          <div class="vocab-pronunciation">
           /ˈwɔː.kweɪ/
          </div><button class="audio-btn" onclick="playAudio('walkway', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Lối đi - The enlarged oak walkways create a generous provision for pedestrians to enjoy the views of the river and meadows.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-6" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Underground
          </div>
          <div class="vocab-pronunciation">
           /ˌʌndəˈɡraʊnd/
          </div><button class="audio-btn" onclick="playAudio('underground', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Ngầm - He suffers from claustrophobia so he never travels on underground trains.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-7" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Motorway
          </div>
          <div class="vocab-pronunciation">
           /ˈməʊtəweɪ/
          </div><button class="audio-btn" onclick="playAudio('motorway', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Đường cao tốc - There has been a collision on the southbound stretch of the motorway.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-8" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Technology
          </div>
          <div class="vocab-pronunciation">
           /tekˈnɒlədʒi/
          </div><button class="audio-btn" onclick="playAudio('technology', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Công nghệ - Modern technology is amazing, isn't it?
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-9" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Driverless
          </div>
          <div class="vocab-pronunciation">
           /ˈdraɪvələs/
          </div><button class="audio-btn" onclick="playAudio('driverless', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Không người lái - Electric and driverless cars and buses will make travel safer and more energy efficient.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-10" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Vertical
          </div>
          <div class="vocab-pronunciation">
           /ˈvɜːtɪkl/
          </div><button class="audio-btn" onclick="playAudio('vertical', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Thẳng đứng - Vertical farms and rooftop gardens will produce fresh food locally, and therefore, reduce the cost of food transportation.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-11" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Interactive
          </div>
          <div class="vocab-pronunciation">
           /ˌɪntərˈæktɪv/
          </div><button class="audio-btn" onclick="playAudio('interactive', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Tương tác - Interactive mirrors in shops will show what clothes look like on us and make suggestions based on our size and style.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-12" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Socialize
          </div>
          <div class="vocab-pronunciation">
           /ˈsəʊ.ʃəl.aɪz/
          </div><button class="audio-btn" onclick="playAudio('socialize', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Giao tiếp - I tend not to socialize with my colleagues.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-13" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Measure
          </div>
          <div class="vocab-pronunciation">
           /ˈmeʒə(r)/
          </div><button class="audio-btn" onclick="playAudio('measure', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Đo - These lights will also measure air pollution.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-14" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Sensor
          </div>
          <div class="vocab-pronunciation">
           /ˈsensə(r)/
          </div><button class="audio-btn" onclick="playAudio('sensor', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Cảm ứng - For example, street lights will have sensors that switch on when someone passes by.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-15" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Data
          </div>
          <div class="vocab-pronunciation">
           /ˈdeɪtə/
          </div><button class="audio-btn" onclick="playAudio('data', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Dữ liệu - Almost everything will be connected to exchange data.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-16" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Exchange
          </div>
          <div class="vocab-pronunciation">
           /ɪksˈtʃeɪndʒ/
          </div><button class="audio-btn" onclick="playAudio('exchange', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Trao đổi - Almost everything will be connected to exchange data.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-17" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Foldable
          </div>
          <div class="vocab-pronunciation">
           /ˈfəʊl.də.bəl/
          </div><button class="audio-btn" onclick="playAudio('foldable', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Gấp - This useful foldable bike fits in the boot of your car.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-18" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Floating
          </div>
          <div class="vocab-pronunciation">
           /ˈfləʊ.tɪŋ/
          </div><button class="audio-btn" onclick="playAudio('floating', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Nổi - These floating buildings won't use valuable land.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-19" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Solar
          </div>
          <div class="vocab-pronunciation">
           /ˈsəʊlə(r)/
          </div><button class="audio-btn" onclick="playAudio('solar', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Mặt trời - They are searching for intelligent life forms in other solar systems.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-20" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Drone
          </div>
          <div class="vocab-pronunciation">
           /drəʊn/
          </div><button class="audio-btn" onclick="playAudio('drone', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Không người lái - A drone or a robot will quickly deliver it in the city of the future.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-21" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Access
          </div>
          <div class="vocab-pronunciation">
           /ˈækses/
          </div><button class="audio-btn" onclick="playAudio('access', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Truy cập - These cities will provide free Internet access to all their citizens.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-22" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Citizen
          </div>
          <div class="vocab-pronunciation">
           /ˈsɪtɪzn/
          </div><button class="audio-btn" onclick="playAudio('citizen', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Cư dân - The interests of British citizens living abroad are protected by the British Embassy.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-23" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Device
          </div>
          <div class="vocab-pronunciation">
           /dɪˈvaɪs/
          </div><button class="audio-btn" onclick="playAudio('device', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Thiết bị - Rescuers used a special device for finding people trapped in collapsed buildings.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-24" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Valuable
          </div>
          <div class="vocab-pronunciation">
           /ˈvæljuəbl/
          </div><button class="audio-btn" onclick="playAudio('valuable', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Có giá trị - These floating buildings won't use valuable land.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-25" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Air pollution
          </div>
          <div class="vocab-pronunciation">
           /ˈeə pəˌluː.ʃən/
          </div><button class="audio-btn" onclick="playAudio('air pollution', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Ô nhiễm không khí - Diesel exhaust is a major contributor to air pollution.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-26" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Deliver
          </div>
          <div class="vocab-pronunciation">
           /dɪˈlɪvə(r)/
          </div><button class="audio-btn" onclick="playAudio('deliver', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Vận chuyển - A drone or a robot will quickly deliver it in the city of the future.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-27" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Necessary
          </div>
          <div class="vocab-pronunciation">
           /ˈnesəsəri/
          </div><button class="audio-btn" onclick="playAudio('necessary', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Cần thiết - Growing food in the city will also be necessary.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-28" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Base on
          </div>
          <div class="vocab-pronunciation">
           /beɪs ɒn/
          </div><button class="audio-btn" onclick="playAudio('base on', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Dựa vào - The film is based on a short story by Thomas Mann.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
       <div class="flashcard" id="card-29" onclick="flipCard(this)">
        <div class="flashcard-inner">
         <div class="flashcard-front">
          <div class="vocab-word">
           Experience
          </div>
          <div class="vocab-pronunciation">
           /ɪkˈspɪəriəns/
          </div><button class="audio-btn" onclick="playAudio('experience', event)">🔊</button>
          <div class="flip-hint">
           Click to see meaning
          </div>
         </div>
         <div class="flashcard-back">
          <div class="vocab-meaning">
           Trải nghiệm - A trip to the mall is going to be a high tech, social experience.
          </div>
          <div class="flip-hint">
           Click to flip back
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div><!-- Grammar Tab -->
    <div class="tab-content" id="grammar">
     <div class="lesson-card">
      <div class="lesson-title">
       Future Predictions
      </div>
      <p><strong>Will + base verb:</strong> Used for predictions based on opinion or belief</p>
      <p>Example: "Cities will be completely digital in the future."</p>
      <p><strong>Be going to + base verb:</strong> Used for predictions based on present evidence</p>
      <p>Example: "Look at those dark clouds! It's going to rain."</p>
      <p><strong>Present Continuous:</strong> Used for planned future arrangements</p>
      <p>Example: "We are visiting the smart city exhibition next week."</p>
      <p><strong>Present Simple:</strong> Used for scheduled future events</p>
      <p>Example: "The conference starts at 9 AM tomorrow."</p>
     </div>
     <div class="lesson-card">
      <div class="lesson-title">
       Adverbs of Certainty
      </div>
      <p><strong>100% Certain:</strong> definitely, certainly, undoubtedly</p>
      <p>Example: "Smart cities will definitely change how we live."</p>
      <p><strong>Very Likely:</strong> probably, most likely</p>
      <p>Example: "Driverless cars will probably be common by 2030."</p>
      <p><strong>50% Certain:</strong> possibly, perhaps, maybe</p>
      <p>Example: "We might possibly see floating buildings in some cities."</p>
      <p><strong>Less Likely:</strong> unlikely, probably not</p>
      <p>Example: "Traditional shopping malls probably won't disappear completely."</p>
      <div style="margin-top: 20px; padding: 15px; background: rgba(102, 126, 234, 0.1); border-radius: 10px;"><strong>Position in sentence:</strong><br>
        • Before main verb: "Cities will probably become smarter."<br>
        • After 'be': "This technology is certainly revolutionary."<br>
        • At the beginning: "Definitely, the future will be digital."
      </div>
     </div>
    </div><!-- Reading Tab -->
    <div class="tab-content" id="reading">
     <div class="lesson-card">
      <div class="lesson-title">
       Reading Passage: Cities of the Future <button class="audio-btn" onclick="readPassage()" style="position: relative; top: 0; right: 0; margin-left: 15px;">🔊</button>
      </div>
      <div class="reading-passage" id="reading-passage">
       <p>The cities of the future will be completely <span class="vocab-highlight" data-word="digital" data-pronunciation="/ˈdɪdʒɪtl/" data-meaning="kỹ thuật số">digital</span> and highly advanced. Smart <span class="vocab-highlight" data-word="technology" data-pronunciation="/tekˈnɒlədʒi/" data-meaning="công nghệ">technology</span> will transform urban living in ways we can barely imagine today.</p>
       <p>In these smart cities, everything will be <span class="vocab-highlight" data-word="connected" data-pronunciation="/kəˈnektɪd/" data-meaning="được kết nối">connected</span> through the Internet of Things. <span class="vocab-highlight" data-word="Sensors" data-pronunciation="/ˈsensəz/" data-meaning="cảm biến">Sensors</span> will monitor air quality, traffic flow, and energy consumption in real-time. Street lights will automatically adjust based on pedestrian traffic, and <span class="vocab-highlight" data-word="driverless" data-pronunciation="/ˈdraɪvələs/" data-meaning="không người lái">driverless</span> vehicles will navigate efficiently through smart traffic systems.</p>
       <p>Housing will also evolve dramatically. <span class="vocab-highlight" data-word="Vertical" data-pronunciation="/ˈvɜːtɪkl/" data-meaning="thẳng đứng">Vertical</span> farms will grow fresh produce in skyscrapers, while <span class="vocab-highlight" data-word="floating" data-pronunciation="/ˈfləʊtɪŋ/" data-meaning="nổi">floating</span> buildings will maximize limited urban <span class="vocab-highlight" data-word="space" data-pronunciation="/speɪs/" data-meaning="không gian">space</span>. These innovative structures will use <span class="vocab-highlight" data-word="solar" data-pronunciation="/ˈsəʊlə/" data-meaning="năng lượng mặt trời">solar</span> energy and other renewable resources.</p>
       <p>Shopping will become an <span class="vocab-highlight" data-word="interactive" data-pronunciation="/ˌɪntərˈæktɪv/" data-meaning="tương tác">interactive</span> and <span class="vocab-highlight" data-word="virtual" data-pronunciation="/ˈvɜːtʃuəl/" data-meaning="ảo">virtual</span> experience. <span class="vocab-highlight" data-word="Drones" data-pronunciation="/drəʊnz/" data-meaning="máy bay không người lái">Drones</span> will <span class="vocab-highlight" data-word="deliver" data-pronunciation="/dɪˈlɪvə/" data-meaning="giao hàng">deliver</span> purchases directly to customers' homes within minutes of ordering.</p>
       <p>All <span class="vocab-highlight" data-word="citizens" data-pronunciation="/ˈsɪtɪzənz/" data-meaning="công dân">citizens</span> will have free <span class="vocab-highlight" data-word="access" data-pronunciation="/ˈækses/" data-meaning="quyền truy cập">access</span> to high-speed internet and smart <span class="vocab-highlight" data-word="devices" data-pronunciation="/dɪˈvaɪsɪz/" data-meaning="thiết bị">devices</span>. This connectivity will enable seamless <span class="vocab-highlight" data-word="data" data-pronunciation="/ˈdeɪtə/" data-meaning="dữ liệu">data</span> <span class="vocab-highlight" data-word="exchange" data-pronunciation="/ɪksˈtʃeɪndʒ/" data-meaning="trao đổi">exchange</span> between city services and residents, making urban life more efficient and sustainable.</p>
      </div>
      <div class="vocabulary-tooltip" id="vocab-tooltip">
       <div class="tooltip-word"></div>
       <div class="tooltip-pronunciation"></div>
       <div class="tooltip-meaning"></div><button class="tooltip-audio" onclick="playTooltipAudio()">🔊</button>
      </div>
     </div>
    </div><!-- Matching Cards Tab -->
    <div class="tab-content" id="matching">
     <div class="lesson-card">
      <div class="lesson-title">
       Vocabulary Matching Game
      </div>
      <div class="matching-controls">
       <div class="matching-info">
        <div class="timer">
         Time: <span id="timer">00:00</span>
        </div>
        <div class="matches">
         Matches: <span id="matches">0/10</span>
        </div>
        <div class="attempts">
         Attempts: <span id="attempts">0</span>
        </div>
       </div><button class="nav-btn" id="shuffle-btn" onclick="shuffleCards()">🔄 New Game</button>
      </div>
      <div class="matching-game-container">
       <div class="matching-grid" id="matching-grid"><!-- Cards will be generated here -->
       </div>
      </div>
      <div class="matching-result" id="matching-result" style="display: none;">
       <h3>🎉 Congratulations!</h3>
       <p>You completed the matching game!</p>
       <div class="result-stats">
        <div>
         Time: <span id="final-time"></span>
        </div>
        <div>
         Attempts: <span id="final-attempts"></span>
        </div>
        <div>
         Accuracy: <span id="accuracy"></span>%
        </div>
       </div><button class="check-btn" onclick="resetMatchingGame()">Play Again</button>
      </div>
     </div>
    </div><!-- Exercises Tab -->
    <div class="tab-content" id="exercises">
     <div class="lesson-card">
      <div class="lesson-title">
       Interactive Exercises
      </div>
      <div class="progress-bar">
       <div class="progress-fill" id="progress-fill"></div>
      </div>
      <div class="score-display" id="score-display">
       Score: 0/0
      </div>
      <div class="exercise-container" id="exercise-container"><!-- Exercises will be loaded here -->
      </div>
     </div>
    </div><!-- Overall Progress Tab -->
    <div class="tab-content" id="progress">
     <div class="lesson-card">
      <div class="lesson-title">
       📊 Tiến Độ Tổng Thể
      </div>
      <div class="progress-grid">
       <div class="progress-item">
        <h4>Vocabulary</h4>
        <div class="progress-score" id="vocab-score">
         0
        </div>
        <div class="progress-label">
         Cards Reviewed
        </div>
        <div class="progress-bar-small">
         <div class="progress-fill-small" id="vocab-progress"></div>
        </div>
       </div>
       <div class="progress-item">
        <h4>Grammar</h4>
        <div class="progress-score" id="grammar-score">
         100%
        </div>
        <div class="progress-label">
         Completed
        </div>
        <div class="progress-bar-small">
         <div class="progress-fill-small" style="width: 100%"></div>
        </div>
       </div>
       <div class="progress-item">
        <h4>Reading</h4>
        <div class="progress-score" id="reading-score">
         0
        </div>
        <div class="progress-label">
         Words Learned
        </div>
        <div class="progress-bar-small">
         <div class="progress-fill-small" id="reading-progress"></div>
        </div>
       </div>
       <div class="progress-item">
        <h4>Matching</h4>
        <div class="progress-score" id="matching-score">
         0%
        </div>
        <div class="progress-label">
         Best Accuracy
        </div>
        <div class="progress-bar-small">
         <div class="progress-fill-small" id="matching-progress"></div>
        </div>
       </div>
       <div class="progress-item">
        <h4>Exercises</h4>
        <div class="progress-score" id="exercise-score">
         0%
        </div>
        <div class="progress-label">
         Accuracy
        </div>
        <div class="progress-bar-small">
         <div class="progress-fill-small" id="exercise-progress"></div>
        </div>
       </div>
      </div>
      <div class="overall-score">
       <h4>Overall Score</h4>
       <div class="overall-score-value" id="overall-score-value">
        0%
       </div>
       <div class="overall-level" id="overall-level">
        Beginner
       </div>
       <div class="achievement-badges">
        <div class="badge hidden" id="vocab-badge">
         🎯 Vocabulary Master
        </div>
        <div class="badge hidden" id="grammar-badge">
         📝 Grammar Expert
        </div>
        <div class="badge hidden" id="reading-badge">
         📖 Reading Champion
        </div>
        <div class="badge hidden" id="matching-badge">
         🃏 Matching Pro
        </div>
        <div class="badge hidden" id="exercise-badge">
         🏆 Exercise Ace
        </div>
       </div>
      </div>
     </div>
    </div>
   </main>
  </div>
  <script>
        // Configuration object for customization
        const defaultConfig = {
            unit_title: "Unit 5: Cities and Education in the future",
            primary_color: "#c8b5ff",
            secondary_color: "#ffb5dc",
            background_color: "#f8f4ff",
            text_color: "#6b5b95",
            surface_color: "#fef7ff"
        };

        let config = { ...defaultConfig };

        // Exercise data - Fill in the blanks
        const exercises = [
            {
                question: "Smart cities _______ definitely change how we live in the future.",
                options: ["will", "are going to", "might", "could"],
                correct: 0,
                explanation: "Use 'will' for predictions based on opinion or belief about the future."
            },
            {
                question: "Look at those construction plans! They _______ build floating buildings next year.",
                options: ["will", "are going to", "might", "should"],
                correct: 1,
                explanation: "Use 'be going to' for predictions based on present evidence (the construction plans)."
            },
            {
                question: "Driverless cars will _______ be common by 2030.",
                options: ["definitely", "probably", "unlikely", "never"],
                correct: 1,
                explanation: "'Probably' expresses that something is very likely to happen (around 70-80% certainty)."
            },
            {
                question: "We _______ visiting the smart city exhibition next week. (It's already scheduled)",
                options: ["will", "are", "might", "could"],
                correct: 1,
                explanation: "Use Present Continuous (are + -ing) for planned future arrangements that are already scheduled."
            },
            {
                question: "The technology conference _______ at 9 AM tomorrow. (It's on the official schedule)",
                options: ["will start", "is starting", "starts", "is going to start"],
                correct: 2,
                explanation: "Use Present Simple for scheduled future events, especially with official timetables."
            },
            {
                question: "Virtual reality shopping will _______ become popular in the next decade.",
                options: ["certainly", "possibly", "definitely not", "never"],
                correct: 1,
                explanation: "'Possibly' expresses 50% certainty - something that might or might not happen."
            },
            {
                question: "Traditional shopping malls _______ disappear completely.",
                options: ["will definitely", "probably won't", "certainly will", "must"],
                correct: 1,
                explanation: "'Probably won't' expresses that something is unlikely to happen."
            },
            {
                question: "Cities will _______ become more sustainable with new technology.",
                options: ["undoubtedly", "might", "could", "should"],
                correct: 0,
                explanation: "'Undoubtedly' (100% certain) expresses complete certainty about future predictions."
            },
            {
                question: "We _______ see flying cars in some cities by 2040.",
                options: ["definitely will", "might possibly", "certainly won't", "never will"],
                correct: 1,
                explanation: "'Might possibly' expresses uncertainty - something that could happen but we're not sure."
            },
            {
                question: "Smart sensors will _______ monitor air quality in future cities.",
                options: ["most likely", "never", "impossibly", "rarely"],
                correct: 0,
                explanation: "'Most likely' expresses high probability (very probable) for future predictions."
            }
        ];

        let currentExercise = 0;
        let score = 0;
        let selectedOption = null;
        let currentCardIndex = 0;
        const totalCards = 30;

        // Overall progress tracking
        let overallProgress = {
            vocabulary: {
                cardsReviewed: 0,
                totalCards: 30
            },
            grammar: {
                completed: true,
                percentage: 100
            },
            reading: {
                wordsLearned: 0,
                totalWords: 15
            },
            matching: {
                bestAccuracy: 0,
                gamesPlayed: 0
            },
            exercises: {
                accuracy: 0,
                completed: false
            }
        };

        // Matching game variables
        let matchingPairs = [];
        let selectedCards = [];
        let matchedPairs = 0;
        let attempts = 0;
        let gameStartTime = null;
        let gameTimer = null;

        // Overall progress functions
        function updateOverallProgress() {
            // Update vocabulary progress
            const vocabPercentage = (overallProgress.vocabulary.cardsReviewed / overallProgress.vocabulary.totalCards) * 100;
            document.getElementById('vocab-score').textContent = overallProgress.vocabulary.cardsReviewed;
            document.getElementById('vocab-progress').style.width = `${vocabPercentage}%`;

            // Update reading progress
            const readingPercentage = (overallProgress.reading.wordsLearned / overallProgress.reading.totalWords) * 100;
            document.getElementById('reading-score').textContent = overallProgress.reading.wordsLearned;
            document.getElementById('reading-progress').style.width = `${readingPercentage}%`;

            // Update matching progress
            document.getElementById('matching-score').textContent = `${overallProgress.matching.bestAccuracy}%`;
            document.getElementById('matching-progress').style.width = `${overallProgress.matching.bestAccuracy}%`;

            // Update exercise progress
            document.getElementById('exercise-score').textContent = `${overallProgress.exercises.accuracy}%`;
            document.getElementById('exercise-progress').style.width = `${overallProgress.exercises.accuracy}%`;

            // Calculate overall score
            const overallScore = Math.round((
                vocabPercentage + 
                overallProgress.grammar.percentage + 
                readingPercentage + 
                overallProgress.matching.bestAccuracy + 
                overallProgress.exercises.accuracy
            ) / 5);

            document.getElementById('overall-score-value').textContent = `${overallScore}%`;

            // Update level
            let level = 'Beginner';
            if (overallScore >= 90) level = 'Expert';
            else if (overallScore >= 75) level = 'Advanced';
            else if (overallScore >= 50) level = 'Intermediate';
            else if (overallScore >= 25) level = 'Elementary';

            document.getElementById('overall-level').textContent = level;

            // Update badges
            updateBadges();
        }

        function updateBadges() {
            // Vocabulary badge (review all cards)
            if (overallProgress.vocabulary.cardsReviewed >= overallProgress.vocabulary.totalCards) {
                document.getElementById('vocab-badge').classList.remove('hidden');
            }

            // Grammar badge (always unlocked)
            document.getElementById('grammar-badge').classList.remove('hidden');

            // Reading badge (learn all words)
            if (overallProgress.reading.wordsLearned >= overallProgress.reading.totalWords) {
                document.getElementById('reading-badge').classList.remove('hidden');
            }

            // Matching badge (80%+ accuracy)
            if (overallProgress.matching.bestAccuracy >= 80) {
                document.getElementById('matching-badge').classList.remove('hidden');
            }

            // Exercise badge (80%+ accuracy)
            if (overallProgress.exercises.accuracy >= 80) {
                document.getElementById('exercise-badge').classList.remove('hidden');
            }
        }

        // Flashcard navigation functionality
        function showCard(index) {
            // Hide all cards
            document.querySelectorAll('.flashcard').forEach(card => {
                card.classList.remove('active');
            });
            
            // Show current card
            document.getElementById(`card-${index}`).classList.add('active');
            
            // Update counter
            document.getElementById('current-card').textContent = index + 1;
            
            // Update button states
            document.getElementById('prev-btn').disabled = index === 0;
            document.getElementById('next-btn').disabled = index === totalCards - 1;

            // Update vocabulary progress
            const maxReviewed = Math.max(overallProgress.vocabulary.cardsReviewed, index + 1);
            if (maxReviewed > overallProgress.vocabulary.cardsReviewed) {
                overallProgress.vocabulary.cardsReviewed = maxReviewed;
                updateOverallProgress();
            }
        }

        function nextCard() {
            if (currentCardIndex < totalCards - 1) {
                currentCardIndex++;
                showCard(currentCardIndex);
            }
        }

        function previousCard() {
            if (currentCardIndex > 0) {
                currentCardIndex--;
                showCard(currentCardIndex);
            }
        }

        // Flashcard flip functionality
        function flipCard(card) {
            card.classList.toggle('flipped');
        }

        // Audio functionality with visual feedback
        function playAudio(word, event) {
            event.stopPropagation(); // Prevent card flip when clicking audio button
            
            const button = event.target;
            button.style.transform = 'scale(0.9)';
            button.style.background = 'linear-gradient(135deg, #fd79a8, #fdcb6e)';
            
            // Create speech synthesis
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(word);
                utterance.lang = 'en-US';
                utterance.rate = 0.8;
                utterance.pitch = 1;
                
                utterance.onend = () => {
                    button.style.transform = 'scale(1)';
                    button.style.background = 'linear-gradient(135deg, #ffeaa7, #fab1a0)';
                };
                
                speechSynthesis.speak(utterance);
            } else {
                // Fallback visual feedback if speech synthesis not available
                setTimeout(() => {
                    button.style.transform = 'scale(1)';
                    button.style.background = 'linear-gradient(135deg, #ffeaa7, #fab1a0)';
                }, 300);
            }
        }

        // Tab switching functionality
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                // Remove active class from all tabs and contents
                document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                // Add active class to clicked tab and corresponding content
                tab.classList.add('active');
                document.getElementById(tab.dataset.tab).classList.add('active');
                
                // Load exercises if exercises tab is clicked
                if (tab.dataset.tab === 'exercises') {
                    loadExercise();
                }
                
                // Initialize matching game if matching tab is clicked
                if (tab.dataset.tab === 'matching') {
                    initializeMatchingGame();
                }
            });
        });

        // Exercise functionality
        function loadExercise() {
            if (currentExercise >= exercises.length) {
                showFinalScore();
                return;
            }

            const exercise = exercises[currentExercise];
            const container = document.getElementById('exercise-container');
            
            container.innerHTML = `
                <div class="question">Question ${currentExercise + 1}: ${exercise.question}</div>
                <div class="options">
                    ${exercise.options.map((option, index) => 
                        `<div class="option" data-index="${index}">${option}</div>`
                    ).join('')}
                </div>
                <button class="check-btn" id="check-btn" disabled>Check Answer</button>
                <div class="feedback" id="feedback"></div>
            `;

            // Add option selection functionality
            document.querySelectorAll('.option').forEach(option => {
                option.addEventListener('click', () => {
                    document.querySelectorAll('.option').forEach(o => o.classList.remove('selected'));
                    option.classList.add('selected');
                    selectedOption = parseInt(option.dataset.index);
                    document.getElementById('check-btn').disabled = false;
                });
            });

            // Add check answer functionality
            document.getElementById('check-btn').addEventListener('click', checkAnswer);
            
            updateProgress();
        }

        function checkAnswer() {
            const exercise = exercises[currentExercise];
            const options = document.querySelectorAll('.option');
            const feedback = document.getElementById('feedback');
            const checkBtn = document.getElementById('check-btn');

            // Show correct/incorrect styling
            options.forEach((option, index) => {
                if (index === exercise.correct) {
                    option.classList.add('correct');
                } else if (index === selectedOption && index !== exercise.correct) {
                    option.classList.add('incorrect');
                }
            });

            // Show feedback
            if (selectedOption === exercise.correct) {
                score++;
                feedback.className = 'feedback correct';
                feedback.textContent = `Correct! ${exercise.explanation}`;
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = `Incorrect. ${exercise.explanation}`;
            }
            
            feedback.style.display = 'block';
            
            // Change button to next
            checkBtn.textContent = currentExercise === exercises.length - 1 ? 'Finish' : 'Next Question';
            checkBtn.onclick = nextExercise;
        }

        function nextExercise() {
            currentExercise++;
            selectedOption = null;
            loadExercise();
        }

        function updateProgress() {
            const progress = (currentExercise / exercises.length) * 100;
            document.getElementById('progress-fill').style.width = `${progress}%`;
            document.getElementById('score-display').textContent = `Score: ${score}/${currentExercise}`;
        }

        function showFinalScore() {
            const container = document.getElementById('exercise-container');
            const percentage = Math.round((score / exercises.length) * 100);
            
            // Update exercise progress
            overallProgress.exercises.accuracy = percentage;
            overallProgress.exercises.completed = true;
            updateOverallProgress();
            
            container.innerHTML = `
                <div style="text-align: center; padding: 40px;">
                    <h2 style="color: ${config.primary_color}; margin-bottom: 20px;">🎉 Exercise Complete!</h2>
                    <div style="font-size: 2rem; font-weight: bold; color: ${config.text_color}; margin-bottom: 10px;">
                        ${score}/${exercises.length}
                    </div>
                    <div style="font-size: 1.2rem; color: ${config.text_color}; margin-bottom: 30px;">
                        ${percentage}% Correct
                    </div>
                    <button class="check-btn" onclick="restartExercises()">Try Again</button>
                </div>
            `;
            
            updateProgress();
        }

        function restartExercises() {
            currentExercise = 0;
            score = 0;
            selectedOption = null;
            loadExercise();
        }

        // Element SDK integration
        async function onConfigChange(newConfig) {
            // Update title
            const titleElement = document.getElementById('unit-title');
            if (titleElement) {
                titleElement.textContent = newConfig.unit_title || defaultConfig.unit_title;
            }

            // Update colors
            const primaryColor = newConfig.primary_color || defaultConfig.primary_color;
            const secondaryColor = newConfig.secondary_color || defaultConfig.secondary_color;
            const backgroundColor = newConfig.background_color || defaultConfig.background_color;
            const textColor = newConfig.text_color || defaultConfig.text_color;
            const surfaceColor = newConfig.surface_color || defaultConfig.surface_color;

            // Apply colors to various elements
            document.documentElement.style.setProperty('--primary-color', primaryColor);
            document.documentElement.style.setProperty('--secondary-color', secondaryColor);
            document.documentElement.style.setProperty('--background-color', backgroundColor);
            document.documentElement.style.setProperty('--text-color', textColor);
            document.documentElement.style.setProperty('--surface-color', surfaceColor);

            // Update body background
            document.body.style.background = `linear-gradient(135deg, ${backgroundColor} 0%, #fff0f8 50%, #f0f8ff 100%)`;
            document.body.style.color = textColor;

            // Update active tab color
            const activeTab = document.querySelector('.nav-tab.active');
            if (activeTab) {
                activeTab.style.background = `linear-gradient(135deg, ${primaryColor} 0%, ${secondaryColor} 100%)`;
            }

            // Update buttons
            document.querySelectorAll('.check-btn').forEach(btn => {
                btn.style.background = `linear-gradient(135deg, ${primaryColor}, ${secondaryColor})`;
            });
        }

        // Initialize Element SDK
        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig,
                onConfigChange,
                mapToCapabilities: (config) => ({
                    recolorables: [
                        {
                            get: () => config.primary_color || defaultConfig.primary_color,
                            set: (value) => {
                                config.primary_color = value;
                                window.elementSdk.setConfig({ primary_color: value });
                            }
                        },
                        {
                            get: () => config.secondary_color || defaultConfig.secondary_color,
                            set: (value) => {
                                config.secondary_color = value;
                                window.elementSdk.setConfig({ secondary_color: value });
                            }
                        },
                        {
                            get: () => config.background_color || defaultConfig.background_color,
                            set: (value) => {
                                config.background_color = value;
                                window.elementSdk.setConfig({ background_color: value });
                            }
                        },
                        {
                            get: () => config.text_color || defaultConfig.text_color,
                            set: (value) => {
                                config.text_color = value;
                                window.elementSdk.setConfig({ text_color: value });
                            }
                        },
                        {
                            get: () => config.surface_color || defaultConfig.surface_color,
                            set: (value) => {
                                config.surface_color = value;
                                window.elementSdk.setConfig({ surface_color: value });
                            }
                        }
                    ],
                    borderables: [],
                    fontEditable: undefined,
                    fontSizeable: undefined
                }),
                mapToEditPanelValues: (config) => new Map([
                    ["unit_title", config.unit_title || defaultConfig.unit_title]
                ])
            });
        }

        // Vocabulary tooltip functionality
        let currentTooltipWord = '';
        let tooltipTimeout;

        function showVocabTooltip(element, event) {
            const tooltip = document.getElementById('vocab-tooltip');
            const word = element.dataset.word;
            const pronunciation = element.dataset.pronunciation;
            const meaning = element.dataset.meaning;

            // Update tooltip content
            tooltip.querySelector('.tooltip-word').textContent = word;
            tooltip.querySelector('.tooltip-pronunciation').textContent = pronunciation;
            tooltip.querySelector('.tooltip-meaning').textContent = meaning;
            
            // Store current word for audio
            currentTooltipWord = word;

            // Mark word as learned if not already
            if (!element.classList.contains('learned')) {
                element.classList.add('learned');
                overallProgress.reading.wordsLearned++;
                updateOverallProgress();
            }

            // Position tooltip
            const rect = element.getBoundingClientRect();
            const tooltipRect = tooltip.getBoundingClientRect();
            
            let left = rect.left + (rect.width / 2) - (250 / 2); // Center tooltip
            let top = rect.top - 120; // Position above the word

            // Adjust if tooltip goes off screen
            if (left < 10) left = 10;
            if (left + 250 > window.innerWidth - 10) left = window.innerWidth - 260;
            if (top < 10) top = rect.bottom + 10; // Position below if no space above

            tooltip.style.left = left + 'px';
            tooltip.style.top = top + 'px';
            tooltip.classList.add('show');

            // Clear any existing timeout
            clearTimeout(tooltipTimeout);
        }

        function hideVocabTooltip() {
            const tooltip = document.getElementById('vocab-tooltip');
            tooltipTimeout = setTimeout(() => {
                tooltip.classList.remove('show');
            }, 300);
        }

        function playTooltipAudio() {
            if (currentTooltipWord && 'speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(currentTooltipWord);
                utterance.lang = 'en-US';
                utterance.rate = 0.8;
                utterance.pitch = 1;
                speechSynthesis.speak(utterance);
            }
        }

        function readPassage() {
            const passage = document.getElementById('reading-passage');
            const text = passage.textContent || passage.innerText;
            
            if ('speechSynthesis' in window) {
                // Stop any current speech
                speechSynthesis.cancel();
                
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'en-US';
                utterance.rate = 0.7;
                utterance.pitch = 1;
                utterance.volume = 0.8;
                
                speechSynthesis.speak(utterance);
            }
        }

        // Matching Game Functions
        const matchingVocabulary = [
            { word: "Digital", meaning: "Kỹ thuật số" },
            { word: "Technology", meaning: "Công nghệ" },
            { word: "Connected", meaning: "Được kết nối" },
            { word: "Virtual", meaning: "Ảo" },
            { word: "Interactive", meaning: "Tương tác" },
            { word: "Sensors", meaning: "Cảm biến" },
            { word: "Driverless", meaning: "Không người lái" },
            { word: "Vertical", meaning: "Thẳng đứng" },
            { word: "Floating", meaning: "Nổi" },
            { word: "Solar", meaning: "Năng lượng mặt trời" }
        ];

        function initializeMatchingGame() {
            resetMatchingGame();
            generateMatchingCards();
        }

        function generateMatchingCards() {
            const grid = document.getElementById('matching-grid');
            grid.innerHTML = '';
            
            // Create cards array with words and meanings
            const cards = [];
            matchingVocabulary.forEach((pair, index) => {
                cards.push({
                    id: `word-${index}`,
                    content: pair.word,
                    type: 'word',
                    pairId: index
                });
                cards.push({
                    id: `meaning-${index}`,
                    content: pair.meaning,
                    type: 'meaning',
                    pairId: index
                });
            });

            // Shuffle cards
            shuffleArray(cards);

            // Create card elements
            cards.forEach(card => {
                const cardElement = document.createElement('div');
                cardElement.className = `matching-card ${card.type}`;
                cardElement.dataset.cardId = card.id;
                cardElement.dataset.pairId = card.pairId;
                cardElement.textContent = card.content;
                cardElement.addEventListener('click', () => selectCard(cardElement));
                grid.appendChild(cardElement);
            });
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function selectCard(cardElement) {
            // Ignore if card is already matched or selected
            if (cardElement.classList.contains('matched') || cardElement.classList.contains('selected')) {
                return;
            }

            // Start timer on first click
            if (!gameStartTime) {
                startGameTimer();
            }

            // Add to selected cards
            cardElement.classList.add('selected');
            selectedCards.push(cardElement);

            // Check for match when 2 cards are selected
            if (selectedCards.length === 2) {
                attempts++;
                updateAttempts();
                
                setTimeout(() => {
                    checkMatch();
                }, 500);
            }
        }

        function checkMatch() {
            const [card1, card2] = selectedCards;
            const pairId1 = parseInt(card1.dataset.pairId);
            const pairId2 = parseInt(card2.dataset.pairId);

            if (pairId1 === pairId2) {
                // Match found
                card1.classList.remove('selected');
                card2.classList.remove('selected');
                card1.classList.add('matched');
                card2.classList.add('matched');
                
                matchedPairs++;
                updateMatches();

                // Check if game is complete
                if (matchedPairs === matchingVocabulary.length) {
                    setTimeout(() => {
                        endGame();
                    }, 500);
                }
            } else {
                // No match
                card1.classList.add('wrong');
                card2.classList.add('wrong');
                
                setTimeout(() => {
                    card1.classList.remove('selected', 'wrong');
                    card2.classList.remove('selected', 'wrong');
                }, 600);
            }

            selectedCards = [];
        }

        function startGameTimer() {
            gameStartTime = Date.now();
            gameTimer = setInterval(() => {
                const elapsed = Date.now() - gameStartTime;
                const minutes = Math.floor(elapsed / 60000);
                const seconds = Math.floor((elapsed % 60000) / 1000);
                document.getElementById('timer').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function updateMatches() {
            document.getElementById('matches').textContent = `${matchedPairs}/${matchingVocabulary.length}`;
        }

        function updateAttempts() {
            document.getElementById('attempts').textContent = attempts;
        }

        function endGame() {
            clearInterval(gameTimer);
            
            const totalTime = Date.now() - gameStartTime;
            const minutes = Math.floor(totalTime / 60000);
            const seconds = Math.floor((totalTime % 60000) / 1000);
            const timeString = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            const accuracy = Math.round((matchingVocabulary.length / attempts) * 100);

            // Update best accuracy
            if (accuracy > overallProgress.matching.bestAccuracy) {
                overallProgress.matching.bestAccuracy = accuracy;
            }
            overallProgress.matching.gamesPlayed++;
            updateOverallProgress();

            document.getElementById('final-time').textContent = timeString;
            document.getElementById('final-attempts').textContent = attempts;
            document.getElementById('accuracy').textContent = accuracy;
            
            document.getElementById('matching-result').style.display = 'block';
        }

        function shuffleCards() {
            resetMatchingGame();
            generateMatchingCards();
        }

        function resetMatchingGame() {
            // Reset game state
            selectedCards = [];
            matchedPairs = 0;
            attempts = 0;
            gameStartTime = null;
            
            // Clear timer
            if (gameTimer) {
                clearInterval(gameTimer);
                gameTimer = null;
            }
            
            // Reset UI
            document.getElementById('timer').textContent = '00:00';
            document.getElementById('matches').textContent = `0/${matchingVocabulary.length}`;
            document.getElementById('attempts').textContent = '0';
            document.getElementById('matching-result').style.display = 'none';
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            // Apply initial config
            onConfigChange(config);

            // Initialize overall progress
            updateOverallProgress();

            // Add vocabulary highlight event listeners
            document.querySelectorAll('.vocab-highlight').forEach(element => {
                element.addEventListener('mouseenter', (e) => showVocabTooltip(element, e));
                element.addEventListener('mouseleave', hideVocabTooltip);
                element.addEventListener('click', (e) => {
                    e.preventDefault();
                    playTooltipAudio();
                });
            });

            // Keep tooltip visible when hovering over it
            const tooltip = document.getElementById('vocab-tooltip');
            tooltip.addEventListener('mouseenter', () => clearTimeout(tooltipTimeout));
            tooltip.addEventListener('mouseleave', hideVocabTooltip);
        });
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'995969530033bcca',t:'MTc2MTY0Mzc5NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>